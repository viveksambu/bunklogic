<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BunkLogic | Animated Dashboard</title>

<style>
/* ---------- BASE ---------- */
*{box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{
    margin:0;min-height:100vh;
    background:linear-gradient(135deg,#667eea,#764ba2);
    display:flex;justify-content:center;align-items:center;
    padding:20px;
}

/* ---------- CARD ---------- */
.container{
    width:100%;max-width:1100px;
    background:rgba(255,255,255,0.95);
    backdrop-filter:blur(10px);
    border-radius:20px;
    padding:30px;
    box-shadow:0 30px 60px rgba(0,0,0,.25);
    animation:fadeUp .8s ease;
}
@keyframes fadeUp{
    from{opacity:0;transform:translateY(30px)}
    to{opacity:1;transform:translateY(0)}
}

/* ---------- HEADER ---------- */
.header{
    display:flex;justify-content:space-between;align-items:center;
    flex-wrap:wrap;gap:15px
}
.brand{display:flex;align-items:center}
.logo{
    width:48px;height:48px;border-radius:50%;
    background:linear-gradient(135deg,#667eea,#764ba2);
    color:#fff;font-weight:900;
    display:flex;align-items:center;justify-content:center;
    margin-right:12px
}
.brand-text{font-size:26px;font-weight:800;color:#5a67d8}
.tagline{font-size:13px;color:#666}

/* ---------- INFO ---------- */
.info{
    background:#f6f7ff;
    padding:14px 18px;
    border-radius:14px;
    margin:20px 0;
    font-weight:600;
    color:#444;
    animation:fadeUp 1s ease;
}

/* ---------- STATS ---------- */
.stats{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:16px;
    margin-bottom:25px;
}
.stat{
    background:linear-gradient(135deg,#eef0ff,#fafbff);
    padding:18px;
    border-radius:16px;
    text-align:center;
    animation:scaleIn .6s ease;
}
@keyframes scaleIn{
    from{transform:scale(.85);opacity:0}
    to{transform:scale(1);opacity:1}
}
.stat h3{margin:0;font-size:28px;color:#5a67d8}
.stat p{margin:5px 0 0;font-size:13px;color:#666}

/* ---------- TABLE ---------- */
.table-wrap{overflow-x:auto;border-radius:14px}
table{
    width:100%;border-collapse:collapse;min-width:750px
}
th{
    background:#eef0ff;
    padding:14px;font-size:13px;
    text-transform:uppercase;letter-spacing:.5px
}
td{
    padding:14px;text-align:center;
    border-bottom:1px solid #eee;
    font-size:14px
}
tr{animation:fadeUp .6s ease}
tr:hover{background:#fafaff}

/* ---------- STATUS ---------- */
.badge{
    padding:6px 14px;border-radius:20px;
    font-size:12px;font-weight:700
}
.safe{background:#e6fffa;color:#0a7d5d}
.warning{background:#fff4e5;color:#b36b00}
.danger{background:#ffe6e6;color:#b00020}

/* ---------- CHARTS ---------- */
.charts{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
    gap:20px;
    margin-top:25px;
}
canvas{
    background:#fff;
    border-radius:16px;
    padding:10px;
    box-shadow:0 10px 25px rgba(0,0,0,.15);
}

/* ---------- FOOTER ---------- */
.footer{
    margin-top:25px;
    display:flex;justify-content:space-between;align-items:center;
    flex-wrap:wrap;gap:10px
}
button{
    padding:12px 22px;border-radius:12px;
    border:none;font-size:14px;font-weight:600;
    cursor:pointer;
    background:linear-gradient(135deg,#667eea,#764ba2);
    color:#fff
}

/* ---------- WATERMARK ---------- */
.watermark{
    position:fixed;bottom:10px;right:12px;
    font-size:11px;color:rgba(255,255,255,.7);
    user-select:none
}
</style>
</head>

<body>

<div class="container">

<!-- HEADER -->
<div class="header">
    <div class="brand">
        <div class="logo">BL</div>
        <div>
            <div class="brand-text">BunkLogic</div>
            <div class="tagline">Smart Attendance Analyzer & Bunk Planner</div>
        </div>
    </div>
    <strong>Step 4 of 4</strong>
</div>

<!-- INFO -->
<div class="info" id="studentInfo"></div>

<!-- STATS -->
<div class="stats">
    <div class="stat">
        <h3 id="totalSubjects">0</h3>
        <p>Subjects</p>
    </div>
    <div class="stat">
        <h3 id="safeCount">0</h3>
        <p>Safe Subjects</p>
    </div>
    <div class="stat">
        <h3 id="riskCount">0</h3>
        <p>At Risk</p>
    </div>
</div>

<!-- TABLE -->
<div class="table-wrap">
<table>
<thead>
<tr>
    <th>Subject</th>
    <th>Total Hours</th>
    <th>Min Attend</th>
    <th>Absent</th>
    <th>Remaining Bunks</th>
    <th>Status</th>
</tr>
</thead>
<tbody id="report"></tbody>
</table>
</div>

<!-- CHARTS -->
<div class="charts">
    <canvas id="barChart" height="250"></canvas>
    <canvas id="pieChart" height="250"></canvas>
</div>

<!-- FOOTER -->
<div class="footer">
    <button onclick="history.back()">â¬… Back</button>
    <span style="color:#666;font-size:13px">Plan smart. Bunk responsibly ðŸ˜„</span>
</div>

</div>

<div class="watermark">SAMBU&nbsp;VIVEK&nbsp;CHAITANYA</div>

<script>
/* ---------- DATA ---------- */
const name = localStorage.getItem("name");
const sap = localStorage.getItem("sap");
const minAttendance = Number(localStorage.getItem("minAttendance"));
const weeks = Number(localStorage.getItem("weeks"));
const subjects = JSON.parse(localStorage.getItem("subjects"));

document.getElementById("studentInfo").innerHTML =
`ðŸ‘¤ <strong>${name}</strong> | ðŸŽ“ ${sap} | ðŸ“Š Target: ${minAttendance}%`;

let safe=0, risk=0;
const report = document.getElementById("report");

let labels=[], values=[];

subjects.forEach(sub=>{
    const total=sub.weekly*weeks;
    const minAttend=Math.ceil(total*(minAttendance/100));
    const maxBunk=total-minAttend;
    const remaining=maxBunk-sub.absent;

    let cls="safe", text="SAFE";
    if(remaining<0){cls="danger";text="SHORTAGE";risk++;}
    else if(remaining<=2){cls="warning";text="WARNING";risk++;}
    else safe++;

    labels.push(sub.name);
    values.push(remaining);

    report.innerHTML+=`
    <tr>
        <td>${sub.name}</td>
        <td>${total}</td>
        <td>${minAttend}</td>
        <td>${sub.absent}</td>
        <td>${remaining}</td>
        <td><span class="badge ${cls}">${text}</span></td>
    </tr>`;
});

/* ---------- ANIMATED NUMBERS ---------- */
function animate(id,val){
    let c=0;
    const el=document.getElementById(id);
    const i=setInterval(()=>{
        el.innerText=c++;
        if(c>val) clearInterval(i);
    },30);
}
animate("totalSubjects",subjects.length);
animate("safeCount",safe);
animate("riskCount",risk);

/* ---------- BAR CHART ---------- */
const b=document.getElementById("barChart").getContext("2d");
const bw=60,gap=25;
values.forEach((v,i)=>{
    b.fillStyle="#667eea";
    b.fillRect(i*(bw+gap)+40,220-v*8,bw,v*8);
    b.fillStyle="#333";
    b.fillText(labels[i],i*(bw+gap)+40,240);
});

/* ---------- PIE CHART ---------- */
const p=document.getElementById("pieChart").getContext("2d");
const total= safe+risk;
let start=0;
[[safe,"#4caf50"],[risk,"#ff9800"]].forEach(d=>{
    p.beginPath();
    p.moveTo(125,125);
    p.fillStyle=d[1];
    p.arc(125,125,100,start,start+(d[0]/total)*Math.PI*2);
    p.fill();
    start+=(d[0]/total)*Math.PI*2;
});
</script>

</body>
</html>
